(function(m){var t=window.AmazonUIPageJS||window.P,l=t._namespace||t.attributeErrors,e=l?l("BuyBackAssets",""):t;e.guardFatal?e.guardFatal(m)(e,window):e.execute(function(){m(e,window)})})(function(m,t,l){m.when("A","atf").register("buyBackConstants",function(e){return{vsxConstants:{EXECUTING_FEATURE_NAME_VSX:"vsx",DEVICE_BRAND:"brand",DEVICE_MODEL:"model"},common:{EMPTY_STRING:"",EMPTY_SPACE_STRING:" ",POST:"post",DELIMITER:"_",DEVICE_TYPE:"Desktop",BUYBACK_MOBILE:"Mobile",ZERO:0},action:{CHANGE:"change",
BUYBACK_LAST_DROPDOWN_SELECTED:"buyback-last-dropdown-selected",APPLY_EXCHANGE_BUTTON_CLICKED:"apply-exchange-button-selected",APPLY_EXCHANGE_BUTTON_EXECUTION:"apply-exchange-button-execution",SHOW_BUYBACK_IMEI_DISPLAY_SECTION:"show-buyback-imei-display-section",UPDATE_BUYBACK_MODAL_HEIGHT:"update-buyback-modal-height",BUYBACK_OFFER_SUCCESSFULLY_APPLIED:"buyback-offer-successfully-applied",SET_PRICE_WITH_BUYBACK_OFFER:"set-price-with-buyback-offer",SHOW_BUYBACK_POST_OFFER_SELECTION_EXPERIENCE:"show-buyback-post-offer-selection-experience",
SHOW_BUYBACK_IMEI_CONTENT:"show-buyback-imei-content",HIDE_BUYBACK_IMEI_CONTENT:"hide-buyback-imei-content",SET_PRICE_WITH_VALUE_COMMENSURATE_OFFER:"set-price-with-buyback-offer-in-imei",TRIGGER_IMAGE_LOAD:"a:image:lazyLoad",PAGE_UPDATE:"a:pageUpdate",RESET_ACCORDION_CONTENT:"reset-accordion-content",UNLOAD_PAGE:"beforeunload"},cssClass:{HIDE:"hide",SHOW:"show"},RTLAErrorStatus:{FATAL:"FATAL",ERROR:"ERROR",WARN:"WARN"},selectors:{BUYBACK_OFFER_SECONDARY_VIEW_ID:"#buyback-offer-secondary-view",AUI_PAGE_STATE_SCRIPT_TAG:"script[type\x3da-state]",
MODAL_RIGHT_COLUMN:"rightColumn",MODAL_LEFT_COLUMN:"leftColumn",MODAL_LEFT_COLUMN_CONTENT:"leftColumnContent",SERVICE_FAILED_ALERT:"buyBackServiceFailedAlert",DEVICE_CHECK_NOTE_2:"buybackDeviceCheckNote2",DROP_DOWN_0:"buyBackDropDown0"}}});m.when("A","atf").register("valueCommensurateConstants",function(e){return{action:{VALUE_COMMENSURATE_BUCKET_SELECTED:"value-commensurate-bucket-selected",VALUE_COMMENSURATE_TEMPLATE_RENDERED:"value-commensurate-template-rendered",INITIALISE_VALUE_COMMENSURATE_DATA:"initialise-value-commensurate-data"},
cssClass:{TOGGLE_OFF:"buyback-valueCommensurate-selectionTable-toggleOff",TOGGLE_ON:"buyback-valueCommensurate-selectionTable-toggleOn"},selector:{COLUMN:"Column",DISCOUNT_PRICE:"valueCommensurateDiscountPrice",DISCOUNT_PRICE_INSIDE_ACCORDION:"valueCommensurateDiscountPriceInsideAccordion",DISCOUNT_PRICE_INSIDE_ACCORDION_TEXT:"valueCommensurateOfferAppliedInAccordionSuccessText",SPONSOR_DISCOUNT:"buyBackValueCommensurateSponsorDiscount",SPONSOR_DISCOUNT_TEXT:"buyBackValueCommensurateSponsoredDiscountText",
OFFER_APPLIED_SUCCESS:"valueCommensurateOfferAppliedSuccess",OFFER_APPLIED_SUCCESS_TEXT:"valueCommensurateOfferAppliedSuccessText"},common:{RENDER_MANUAL_BUCKET_TEMPLATES_URL:"/md/renderValueCommensurateManualTemplate",SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_URL:"/md/saveValueCommensurateCustomerData",TEMPLATE_INGRESS_ID:"buyBackValueCommensurateIngress",HAS_VALUE_COMMENSURATE_OFFERS:"hasValueCommensurateOffers",CAMPAIGN_ID:"campaignId",VALUE_COMMENSURATE_OFFER_LOADER_ID:"valueCommensurateOfferLoaderSpinner",
BASE_BUYBACK_DISCOUNT_REDUCTION_PERCENTAGE:.9},metricName:{RENDER_MANUAL_BUCKET_TEMPLATES_SUCCESS:"BuyBack:ValueCommensurate:RendereManualBucketTemplate:Success:Desktop",RENDER_MANUAL_BUCKET_TEMPLATES_FAILURE:"BuyBack:ValueCommensurate:RendereManualBucketTemplate:Failure:Desktop",SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_SUCCESS:"BuyBack:ValueCommensurate:SaveCustomerData:Success:Desktop",SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_FAILURE:"BuyBack:ValueCommensurate:SaveCustomerData:Failure:Desktop",RENDER_MANUAL_BUCKET_TEMPLATES_TIME:"BuyBack:ValueCommensurate:RendereManualBucketTemplate:Time:Desktop"}}});
m.when("A").register("weblabConstants",function(e){return{treatment:{T1:"T1",C:"C"}}});m.when("A","valueCommensurateUtils","buyBackConstants","valueCommensurateConstants","Logger","bbMetric","buyback-util","atf").register("valueCommensurateHandler",function(e,n,g,b,q,c,k){function u(){q.log("initialiseData");F={};G={};C.empty();I=D=J=E=null;H=!1;z=null}function K(a){a?M[0]===l&&E.toLowerCase()===d.BUYBACK_MOBILE.toLowerCase()&&N.addClass(p.HIDE):M[0]===l&&E.toLowerCase()===d.BUYBACK_MOBILE.toLowerCase()&&
N.removeClass(p.HIDE)}var a=e.$,r=g.action,d=g.common,p=g.cssClass,A=g.selectors,w=b.action,x=b.common,m=b.metricName,t=b.selector,C=a("#"+x.TEMPLATE_INGRESS_ID),y=a("#"+x.VALUE_COMMENSURATE_OFFER_LOADER_ID),N=a("#"+A.DEVICE_CHECK_NOTE_2),M=a("#"+A.DROP_DOWN_0),F={},G={},J,E,D,I,H=!1,z;e.on(r.BUYBACK_LAST_DROPDOWN_SELECTED,function(a){q.log(r.BUYBACK_LAST_DROPDOWN_SELECTED);y.removeClass(p.HIDE).addClass(p.SHOW);u();E=a.buyBackCategory;J=a.buyBackItemId;I=a.requestId;c.startTimer(m.RENDER_MANUAL_BUCKET_TEMPLATES_TIME);
n.renderValueCommensurateManualBucketTemplates(a);c.stopTimer(m.RENDER_MANUAL_BUCKET_TEMPLATES_TIME)});e.on(w.VALUE_COMMENSURATE_TEMPLATE_RENDERED,function(a){q.log(w.VALUE_COMMENSURATE_TEMPLATE_RENDERED);y.removeClass(p.SHOW).addClass(p.HIDE);k.hide(A.SERVICE_FAILED_ALERT);e.trigger(r.UPDATE_BUYBACK_MODAL_HEIGHT);var d=a.html;a.loadedSuccessfully?(C.html(d),e.trigger(r.TRIGGER_IMAGE_LOAD),a=C[0].querySelector("#"+x.HAS_VALUE_COMMENSURATE_OFFERS),(H=JSON.parse(a.value))?(K(!0),D=C[0].querySelector("#"+
x.CAMPAIGN_ID).value):(K(!1),e.trigger(r.BUYBACK_OFFER_SUCCESSFULLY_APPLIED,{hasValueCommensurateOffers:!1}))):k.show(A.SERVICE_FAILED_ALERT)});e.declarative(w.VALUE_COMMENSURATE_BUCKET_SELECTED,r.CHANGE,function(d){q.log(w.VALUE_COMMENSURATE_BUCKET_SELECTED);var b=d.data;d=b.bucket;var p=b.lineItem;z=b.value;F.hasOwnProperty(d)&&n.toggleOff(F[d]);b=a("#"+(p+t.COLUMN));F[d]=b;n.toggleOn(b);G[d]=p;d={};d.valueCommensurateTotalDiscount=z;d.hasValueCommensurateOffers=!0;e.trigger(r.BUYBACK_OFFER_SUCCESSFULLY_APPLIED,
d);e.trigger(r.RESET_ACCORDION_CONTENT)});e.on(r.APPLY_EXCHANGE_BUTTON_CLICKED,function(){q.log(r.APPLY_EXCHANGE_BUTTON_CLICKED);var a={};if(H){var d=[],b;for(b in G)d.push(G[b]);n.saveValueCommensurateCustomerData({buyBackItemId:J,buyBackCategory:E,requestId:I,campaignId:D,listOfManualDefects:d});a.hasValueCommensurateOffers=!0;a.valueCommensurateTotalDiscount=z}else a.hasValueCommensurateOffers=!1;e.trigger(r.APPLY_EXCHANGE_BUTTON_EXECUTION,a)});e.on(r.SET_PRICE_WITH_VALUE_COMMENSURATE_OFFER,function(){q.log(r.SET_PRICE_WITH_VALUE_COMMENSURATE_OFFER);
var a={};H?(a.hasValueCommensurateOffers=!0,a.valueCommensurateTotalDiscount=z):a.hasValueCommensurateOffers=!1;e.trigger(r.SET_PRICE_WITH_BUYBACK_OFFER,a)});e.on(w.INITIALISE_VALUE_COMMENSURATE_DATA,function(){q.log(w.INITIALISE_VALUE_COMMENSURATE_DATA);u()});e.on(r.PAGE_UPDATE,function(){q.log(r.PAGE_UPDATE);C=a("#"+x.TEMPLATE_INGRESS_ID);y=a("#"+x.VALUE_COMMENSURATE_OFFER_LOADER_ID);N=a("#"+A.DEVICE_CHECK_NOTE_2);M=a("#"+A.DROP_DOWN_0)})});"use strict";m.when("A").register("bbg-atc-handler-component",
function(e){var n=!1;return{setBbgAddToCartApiCalled:function(e){n=e},isBbgAddToCartApiCalled:function(){return n}}});"use strict";m.when("A").register("bbMetric",function(e){var n=t.ue,g={};return{increment:function(b){"undefined"!==typeof n&&"undefined"!==typeof n.count&&b&&n.count(b,(n.count(b)||0)+1)},stopTimer:function(b){"function"===typeof t.uet&&g.hasOwnProperty(b)&&(delete g[b],t.uet("be",b,{wb:1}),t.uex("ld",b,{wb:1}))},startTimer:function(b){"function"!==typeof t.uet||g.hasOwnProperty(b)||
(g[b]=1,t.uet("bb",b,{wb:1}))},registerRefTag:function(b){e.$.get("/hctp/log/refMarker?ref_\x3d"+b)}}});"use strict";m.when("A","BBPageStateHelper").register("BBPageState",function(e){e.on("a:pageUpdate",function(){e.trigger("a2i_dpx:buyback:processBBPageState")});return{_buyBackState:null,callBBPageState:!1,init:function(){e.state.parse();this._buyBackState=e.state("buyBackPageState")},get:function(){null===this._buyBackState&&this.init();return this._buyBackState},getUpdatedState:function(){e.state.parse();
return this._buyBackState=e.state("buyBackPageState")}}});m.when("A").register("buyBackPageStateStatic",function(e){});"use strict";m.when("A","a-dropdown","bb-first-dropdown","bbMetric").register("BBPageStateHelper",function(e,n,g,b){function q(c){var e="";c={type:"post",url:"/gp/product/features/buyback/buyBackOffersForCategory.html?"+k.param({encryptedMarketPlaceId:c.marketPlaceId,asin:c.asin,productPrice:c.productPrice,brand:c.brand,subCategoryName:c.subCategoryName,encryptedMerchantId:c.sellerId,
postalCode:c.buyBackPostalCode,buyBackCategory:"",rbnHierarchyNodes:c.categoryIdentifier}),async:!1,success:function(a){try{var c=JSON.parse(a)}catch(p){b.increment("BBPageStateHelper:fetchBuyBackExchangeItems:invalidResponse"),e=""}if("undefined"!==typeof c&&"SERVICE-SUCCESS"===c.status&&(e="",""!==c.BestBuyBackOffer&&null!==c.BestBuyBackOffer))try{var d=JSON.parse(c.BestBuyBackOffer);e=d.containedBuyBackProductNodes;b.increment("BBPageStateHelper:fetchBuyBackExchangeItems:success")}catch(p){b.increment("BBPageStateHelper:fetchBuyBackExchangeItems:invalidJSON"),
e=""}},error:function(){e="";b.increment("BBPageStateHelper:fetchBuyBackExchangeItems:failure")}};b.startTimer("BBPageStateHelper:ajax:fetchBuyBackExchangeItems");k.ajax(c);b.stopTimer("BBPageStateHelper:ajax:fetchBuyBackExchangeItems");return e}function c(){e.state.parse();var b=e.state("buyBackPageState");if(b&&b.hasValidBuyBackOffers&&"false"===b.crossCategoryOfferAvailable){var c=q(b);b.buyBackExchangeItems=c;e.state.replace("buyBackPageState",b);g.loadOptions(c)}}var k=e.$;c();return{lazyLoad:c}});
"use strict";m.when("A","bbMetric").register("buyback-suppress-addToCart",function(e,n){var g=e.$;return{hide:function(){g("#addToCart_feature_div").removeClass("show").addClass("hide");n.increment("AddToCartHandler:button:hide:count")},show:function(){g("#addToCart_feature_div").removeClass("hide").addClass("show");n.increment("AddToCartHandler:button:show:count")}}});"use strict";m.when("A","BBPageState","bbMetric").register("BuyBackFeeHandler",function(e,n,g){var b=e.$,q=null,c=!1,k=[];(n=n.getUpdatedState())&&
n.feeMap&&n.feeMap.map&&"object"===typeof n.feeMap.map&&"{}"!==JSON.stringify(n.feeMap.map)&&(q=n.feeMap.map);return{fetchFeeMap:function(n,l){if(q){if(l)try{l(q)}catch(a){g.increment("BuybackFeeHandler:Callback:Exception")}}else k.push(l),c||(c=!0,n="/gp/product/features/buyback/buyBackConvenienceFeeHandler.html?"+b.param({chargeKeyPrefix:n}),e.ajax(n,{method:"get",success:function(a){a&&(q=a.feeMap,e.each(k,function(a,d){if(a)try{a(q)}catch(p){g.increment("BuybackFeeHandler:Callback:Exception")}}),
k=[]);c=!1;g.increment("BuybackFeeHandler:FetchFeeAjaxCall:Success")},error:function(){g.increment("BuybackFeeHandler:FetchFeeAjaxCall:Failure");c=!1;k=[]}}))}}});"use strict";m.when("A","a-checkbox","a-modal","BBPageState","bbMetric","buyBackPageStateStatic").execute(function(e,n,g,b,q){function c(a,c){a=u("form\x3d[id\x3d"+c+"]");if(0===a.find('input[class^\x3d"bbgInputData"]').length){m=b.getUpdatedState();var d=m.bbgAsin,e=m.bbgAsinOfferingId,p=m.bbgOfferId,r=p+"-"+(new Date).getTime(),k=a.find("input[name^\x3d'offeringID']").length+
1;d='\x3cinput class\x3d"bbgInputData-'+c+'" type\x3d"hidden" id\x3d"asin.'+k+'" name\x3d"asin.'+k+'" value\x3d"'+d+'"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" type\x3d"hidden" id\x3d"quantity.'+k+'" name\x3d"quantity.'+k+'" value\x3d"1"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" type\x3d"hidden" id\x3d"offeringID.'+k+'" name\x3d"offeringID.'+k+'" value\x3d"'+e+'"\x3e';e=k+1;e='\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.'+e+'.1" name\x3d"custom-name.'+e+'.1" value\x3d"itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+
c+'" id\x3d"custom-value.'+e+'.1" name\x3d"custom-value.'+e+'.1" value\x3d"'+r+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.'+e+'.2" name\x3d"custom-name.'+e+'.2" value\x3d"itemAssocType" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.'+e+'.2" name\x3d"custom-value.'+e+'.2" value\x3d"BuyBackGuarantee" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.'+e+'.3" name\x3d"custom-name.'+e+'.3" value\x3d"bbgOfferingId" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+
c+'" id\x3d"custom-value.'+e+'.3" name\x3d"custom-value.'+e+'.3" value\x3d"'+p+'" type\x3d"hidden"\x3e';var g=a.find("input[name^\x3d'custom-name.1.']").length+1;c='\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.1.'+g+'" name\x3d"custom-name.1.'+g+'" value\x3d"itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.1.'+g+'" name\x3d"custom-value.1.'+g++ +'" value\x3d"'+r+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.1.'+
g+'" name\x3d"custom-name.1.'+g+'" value\x3d"UNIQ-itemAssoc" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.1.'+g+'" name\x3d"custom-value.1.'+g++ +'" value\x3d"'+r+'" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-name.1.'+g+'" name\x3d"custom-name.1.'+g+'" value\x3d"itemAssocType" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.1.'+g+'" name\x3d"custom-value.1.'+g++ +'" value\x3d"BuyBackGuarantee" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+
c+'" id\x3d"custom-name.1.'+g+'" name\x3d"custom-name.1.'+g+'" value\x3d"bbgOfferingId" type\x3d"hidden"\x3e\x3cinput class\x3d"bbgInputData-'+c+'" id\x3d"custom-value.1.'+g+'" name\x3d"custom-value.1.'+g++ +'" value\x3d"'+p+'" type\x3d"hidden"\x3e';c=d+e+c;p=a.find('input[name\x3d"itemCount"]');0===p.length?c+='\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"'+k+'"\x3e':p.value+=1;a.append(c)}}function k(){m=b.getUpdatedState();!0===m.isbbgOfferAvailable&&(u("[id^\x3d'bbg-checkbox-']").unbind("click").click(function(a){this.checked?
c(a,this.value):u(".bbgInputData-"+this.value).remove()}).each(function(){this.checked?c(event,this.value):u(".bbgInputData-"+this.value).remove()}),u("[id^\x3d'bbg-addButton-']").unbind("click").click(function(a){c(a,this.value);var d=n("#bbg-checkbox-"+this.value),b=g.get(u("#bbg-featureDiv-"+this.value));d.check();null!==b&&b.hide();a.preventDefault()}),u("[id^\x3d'bbg-skipButton-']").unbind("click").click(function(a){u(".bbgInputData-"+this.value).remove();var d=n("#bbg-checkbox-"+this.value),
b=g.get(u("#bbg-featureDiv-"+this.value));d.uncheck();null!==b&&b.hide();a.preventDefault()}),a.forEach(function(a){u(document).undelegate(a,"click.bbg");!0===m.isbbgOfferAvailable&&u(document).delegate(a,"click.bbg",{form:a},r)},a))}var u=e.$;b.init();var m=b.get(),a=["#add-to-cart-button","#buy-now-button","#buyBackBuyNowButton"],r=function(a){u(a.data.form).find('input[class^\x3d"bbgInputData"]')&&(q.increment("BuyBackGuarantee:desktop:bbgAdded:count"),q.increment("BuyBackGuarantee:desktop:bbgAdded:count"+
a.data.form))};m!==l&&(e.on("a2i_dpx:buyback:processBBPageState",function(){k()}),k())});"use strict";m.when("A","a-button","a-dropdown","buyback-util","BBPageState","bbMetric","gep-util","BBPageStateHelper","BuyBackFeeHandler","a-modal","a-popover","weblabConstants","buyBackConstants","valueCommensurateConstants","Logger","buyBackPageStateStatic").execute(function(e,n,g,b,q,c,k,u,K,a,r,d,p,A,w){function x(a){""!==a&&null!==g.getSelect(h('[id\x3d"'+a+'"]'))&&g.getSelect(h('[id\x3d"'+a+'"]')).setValue("");
e.trigger(S.INITIALISE_VALUE_COMMENSURATE_DATA);e.trigger(v.UPDATE_BUYBACK_MODAL_HEIGHT);e.trigger(v.RESET_ACCORDION_CONTENT)}function O(){var a=q.getUpdatedState();h.isEmptyObject(a)||(f.selectOldProductDetailsToolTipText=a.selectOldProductDetailsToolTipText,f.productCategory=a.buyBackCategory,f.buyBackCategory=a.buyBackCategory,f.buyBackprompt1Text=a.buyBackDropDown1prompt,f.buyBackprompt2Text=a.buyBackDropDown2prompt,f.buyBackprompt3Text=a.buyBackDropDown3prompt,f.categoryIdentifier=a.categoryIdentifier,
f.buyBackExchangeItems=a.buyBackExchangeItems,f.currencyCode=a.currencyCode,f.buyBackMobile=a.buyBackMobile,f.buyBoxOfferBuyingPrice=Number(a.buyBoxOfferBuyingPrice),f.feeAsin="",f.feeMap=a.feeMap,aa=f.chooseButtonText=a.chooseButtonText,a.feeAsin!==l&&(f.feeAsin=a.feeAsin),a.convenienceFee?f.convenienceFee=Number(a.convenienceFee):(f.convenienceFee=0,K.fetchFeeMap(f.productCategory,function(a){f.feeMap={map:a};G();f.convenienceFee||c.increment("BuyBack:mobile:noConvenienceFeeConfigured:count")})),
f.asin=a.asin,a.sellerId!==l&&(f.sellerId=a.sellerId),f.brand=a.brand,f.subCategoryName=a.subCategoryName,f.postalCode=a.buyBackPostalCode,f.encryptedMarketPlaceId=a.marketPlaceId,f.productPrice=a.productPrice,f.crossCategoryOfferAvailable=a.crossCategoryOfferAvailable,f.noOfQuestions=a.noOfQuestions,f.gepEligible=a.gepEligibleCustomer,f.vcExperimentalWebalbAllocation=a.vcExperimentalWebalbAllocation,f.valueCommensurateRequestId=a.vcRequestId,f.deviceType=a.deviceType,f.executingFeature=a.executingFeature)}
function Z(a){w.log("buyBackOfferSuccessfullyApplied");var d=f.shouldDisplaySponsorMessage,c=e.state("AdditionalSweetener");c||(e.state.parse(),c=e.state("AdditionalSweetener"));var p=0;h.isEmptyObject(c)||(p=c.sweetener);c=f.totalSponsoredValue-p;a!==l&&!0===a.hasValueCommensurateOffers?(p=a.valueCommensurateTotalDiscount,h("#"+B.DISCOUNT_PRICE).text(b.getFormattedPrice(p)),h("#"+B.DISCOUNT_PRICE_INSIDE_ACCORDION).text(b.getFormattedPrice(p)),h("#"+B.SPONSOR_DISCOUNT).text(b.getFormattedPrice(c)),
0<c&&"1"===d?b.show(B.SPONSOR_DISCOUNT_TEXT):b.hide(B.SPONSOR_DISCOUNT_TEXT),b.show(B.OFFER_APPLIED_SUCCESS,B.OFFER_APPLIED_SUCCESS_TEXT)):(p=(1===f.shouldReduceBuyBackDiscount?b.roundToNearestTen(f.selectedBuyBackOfferData.discountPrice*ba.BASE_BUYBACK_DISCOUNT_REDUCTION_PERCENTAGE):f.selectedBuyBackOfferData.discountPrice)+f.totalSponsoredValue+f.purchaseHistoryDiscount,h("#buyBackDiscountPrice").text(b.getFormattedPrice(p)),h("#buyBackDiscountPriceInsideAccordion").text(b.getFormattedPrice(p)),
h("#buyBackSponsoredDiscount").text(b.getFormattedPrice(c)),0<c&&"1"===d?b.show("buyBackSponsoredDiscountText"):b.hide("buyBackSponsoredDiscountText"),h(".dropDownChosen").each(function(){h(this).removeClass("hide")}),p>Q.ZERO?b.show("buyBackOfferAppliedSuccess","buyBackOfferAppliedSuccessText"):b.hide("buyBackOfferAppliedSuccess","buyBackOfferAppliedSuccessText"),ia());b.hide("buyBackCollectOldProductDetailsText","buyBackServiceFailedAlert");f.buyBackCategory.toLowerCase()===f.buyBackMobile.toLowerCase()&&
e.trigger(v.SHOW_BUYBACK_IMEI_CONTENT);e.trigger(v.SET_PRICE_WITH_BUYBACK_OFFER,a)}function C(){n("#buyBackBuyNowButton").enable()}function y(){n("#buyBackBuyNowButton").disable()}function N(){e.trigger(v.RESET_ACCORDION_CONTENT);c.increment("BuyBack:web:dropDown1Select:count");b.hide("buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackExchangeMightBeEligibleText","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection",
"buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection","bbAppliedState");f.selectedBuyBackOptions[0]=h("#buyBackDropDown1").val();b.show("buyBackDropDowns2");h('[id\x3d"'+f.previousSelectedBuyBackOptions[0]+'Id"]').removeClass("show").addClass("hide");h('[id\x3d"'+f.selectedBuyBackOptions[0]+'Id"]').removeClass("hide").addClass("show");"tv"===f.buyBackCategory.toLowerCase()&&(b.show("buyBackItemWorkingConditionText"),b.hide("refImages"));
b.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection");f.categoryChosen.toLowerCase()===f.buyBackMobile?b.hide("buyBackDropDown3"):b.show("buyBackDropDown3");x(f.previousSelectedBuyBackOptions[0]);if(""!==f.previousSelectedBuyBackOptions[1]){var a=f.previousSelectedBuyBackOptions[0]+f.previousSelectedBuyBackOptions[1];h('[id\x3d"'+a+'Id"]').removeClass("show").addClass("hide");x(a)}f.previousSelectedBuyBackOptions[0]=f.selectedBuyBackOptions[0];1!==f.noOfQuestions||b.setSelectedBuyBackOffer(f)?
y():D(f.selectedBuyBackOptions[0]);h(".dropDownChosen").each(function(){h(this).addClass("hide")});b.hide("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal")}function M(){e.trigger(v.RESET_ACCORDION_CONTENT);c.increment("BuyBack:web:dropDown2Select:count");f.selectedBuyBackOptions[1]=h('[id\x3d"'+f.selectedBuyBackOptions[0]+'"]').val();b.hide("buyBackExchangeMightBeEligibleText");b.hide("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal",
"buyBackBuyNowButton","priceAfterBuyBackDiscountSection");var a=q.getUpdatedState();n("#chooseButton").text(a.chooseButtonText);b.show("maxBuyBackDiscountSection");2!==f.noOfQuestions||b.setSelectedBuyBackOffer(f)?(y(),f.buyBackCategory.toLowerCase()===f.buyBackMobile.toLowerCase()?(e.trigger(v.HIDE_BUYBACK_IMEI_CONTENT),h(".dropDownChosen").each(function(){h(this).addClass("hide")}),b.setSelectedBuyBackOffer(f)||D(f.selectedBuyBackOptions[0])):(b.hide("buyBackOfferAppliedSuccess","buyBackDetailsVerifyText",
"buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIMismatchAlert","buyBackIMEIUpdateText","buyBackDropDown3","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection"),b.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection","buyBackDropDowns3"),""!==f.previousSelectedBuyBackOptions[1]&&(a=f.previousSelectedBuyBackOptions[0]+f.previousSelectedBuyBackOptions[1],h('[id\x3d"'+a+'Id"]').removeClass("show").addClass("hide"),
x(a)),h('[id\x3d"'+f.selectedBuyBackOptions[0]+f.selectedBuyBackOptions[1]+'Id"]').removeClass("hide").addClass("show"),f.previousSelectedBuyBackOptions[1]=f.selectedBuyBackOptions[1])):D(f.selectedBuyBackOptions[0])}function F(){h("#buyBackBuyNow").append('\x3cinput type\x3d"hidden" id\x3d"isBuyBackKey" name\x3d"custom-name.2.1" value\x3d"UNIQ-buyBack"\x3e\x3cinput type\x3d"hidden" id\x3d"isBuyBackFee" name\x3d"custom-value.2.1" value\x3d"BuyBackFee"\x3e')}function G(){if(f.categoryChosen===l||""===
f.categoryChosen)f.categoryChosen=f.productCategory;var a=f.productCategory.toLowerCase()+"_"+f.categoryChosen.toLowerCase();f.convenienceFee="";f.feeAsin="";if(f.feeMap===l){var d="BuyBack:web:noEntryExistsFor"+f.productCategory.toLowerCase()+":count";c.increment(d);c.increment("BuyBack:mobile:feeMapUndefined:count")}else f.feeMap.map[a]===l?(c.increment("BuyBack:web:noEntryExistsFor"+a+":count"),c.increment("BuyBack:mobile:feeMapEntryForChargeKeyUndefined:count")):f.feeMap.map[a].feeEnabled?(d=
f.feeMap.map[a].asin,f.convenienceFee=f.feeMap.map[a].price,""!==f.convenienceFee&&f.convenienceFee!==l||c.increment("BuyBack:mobile:convenienceFeeNotSet:count"),f.feeAsin=d,""!==f.feeAsin&&f.feeAsin!==l||c.increment("BuyBack:mobile:feeAsinNotSet:count"),a=f.feeMap.map[a].offeringId,a!==l&&""!==a||c.increment("BuyBack:mobile:feeOfferingIdUndefined:count"),h("#feeAsin").val(d),h("#feeOfferingId").val(a)):(c.increment("BuyBack:web:feeDisabledFor"+a+":count"),c.increment("BuyBack:mobile:feeDisabled:count"))}
function J(){h("#isBuyBackKey").val("UNIQ-buyBack");h("#isBuyBackFee").val("BuyBackFee")}function E(){h("#feeAsin")[0]!==l&&h("#feeAsin")[0].value!==l&&h("#feeAsin").val("");h("#feeOfferingId")[0]!==l&&h("#feeOfferingId")[0].value!==l&&h("#feeOfferingId").val("");h("#isBuyBackKey")[0]!==l&&h("#isBuyBackKey")[0].value!==l&&h("#isBuyBackKey").val("");h("#isBuyBackFee")[0]!==l&&h("#isBuyBackFee")[0].value!==l&&h("#isBuyBackFee").val("")}function D(a){c.increment("BuyBack:web:discountApply:count");var d=
""===f.categoryChosen.toLowerCase()?f.productCategory:f.categoryChosen.toLowerCase();"mobile"!==d&&"tv"!==d?b.hide("buyBackMobileWorkingConditionNote"):b.show("buyBackMobileWorkingConditionNote");"tv"===f.categoryChosen.toLowerCase()&&b.show("buyBackItemWorkingConditionText");y();c.startTimer("BuyBack:web:ajaxSave");d=b.applyBuyBackOffer(f);c.stopTimer("BuyBack:web:ajaxSave");d?f.vcExperimentalWebalbAllocation!==T.T1||f.selectedBuyBackOfferData.gepEligibleBrandModel?(f.vcExperimentalWebalbAllocation===
T.T1&&f.selectedBuyBackOfferData.gepEligibleBrandModel&&h("#buyBackValueCommensurateIngress").html(""),e.trigger(v.BUYBACK_OFFER_SUCCESSFULLY_APPLIED,{hasValueCommensurateOffers:!1})):(a={},d=f.selectedBuyBackOfferData.offerId.split(Q.DELIMITER),d=d[4]+Q.DELIMITER+d[5],a.buyBackCategory=f.buyBackCategory,a.buyBackItemId=d,a.requestId=f.valueCommensurateRequestId,a.deviceType=Q.DEVICE_TYPE,a.totalBuyBackDiscount=f.selectedBuyBackOfferData.discountPrice+f.totalSponsoredValue+f.purchaseHistoryDiscount,
a.baseBuyBackDiscount=f.selectedBuyBackOfferData.discountPrice+f.purchaseHistoryDiscount,e.trigger(v.BUYBACK_LAST_DROPDOWN_SELECTED,a)):(c.increment("BuyBack:web:dataSaveFailed:count"),b.show("buyBackServiceFailedAlert","buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection"),b.hide("buyBackDetailsVerifyText","buyBackOfferAppliedSuccess","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackIMEISection","buyBackConvenienceFeeTextSection"),x(a))}function I(){var d=ca.css("height"),
b=da.css("height");d>b?U.css("height",d):U.css("height",b);d=a.get("BuyBackModalDialog");d.lock().show().updatePosition();d.unlock()}function H(){e.on("a:dropdown:select",function(a){"buyBackDropDown0"===a.name?V():"buyBackDropDown1"===a.name?N():a.name===h("#buyBackDropDown1").val()?M():a.name===f.selectedBuyBackOptions[0]+f.selectedBuyBackOptions[1]&&(e.trigger(v.RESET_ACCORDION_CONTENT),c.increment("BuyBack:web:dropDown3Select:count"),b.hide("buyBackExchangeMightBeEligibleText"),f.selectedBuyBackOptions[2]=
h('[id\x3d"'+f.selectedBuyBackOptions[0]+f.selectedBuyBackOptions[1]+'"]').val(),b.setSelectedBuyBackOffer(f)||D(f.selectedBuyBackOptions[0]+f.selectedBuyBackOptions[1]))});h("#buyBackIMEITextInput").bind("change input",function(){c.increment("BuyBack:web:imeiInput:count");b.hide("buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackServiceFailedAlert","buyBackTermsAndConditions","buyBackIMEIMismatchAlert","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes");b.show("buyBackVerifyIMEIText");
f&&f.selectedBuyBackOfferData&&f.selectedBuyBackOfferData.gepEligibleBrandModel&&(b.show("buyBackGEPIMEIInfoAlert","buyBackGetImeiGEP"),b.hide("buyBackVerifyIMEIText","buyBackGEPNotEligibleAlert"));b.hide("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal");b.show("buyBackApplyButton");h("#buyBackIMEITextInput").removeClass("a-form-error");y()});h("#buyBackApplyButton").unbind("click").click(function(){c.increment("BuyBack:web:apply:count");f.imeiNumber=h("#buyBackIMEITextInput").val();
if(b.isValidBuyBackIMEI()){var a=b.validateBrandAndModelBasedOnIMEI(f);if("FAILED"===a)c.increment("BuyBack:web:imeiServiceFailed:count"),y(),b.show("buyBackServiceFailedAlert","buyBackVerifyIMEIText"),b.hide("buyBackTermsAndConditions","buyBackIMEIMismatchAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),f.selectedBuyBackOfferData.gepEligibleBrandModel&&b.hide("buyBackVerifyIMEIText");else if("MISMATCH"===a)c.increment("BuyBack:web:imeiMismatch:count"),
y(),h("#buyBackIMEITextInput").addClass("a-form-error"),b.show("buyBackIMEIMismatchAlert","buyBackVerifyIMEIText"),b.hide("buyBackTermsAndConditions","buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buybackImeiBlockAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),f.selectedBuyBackOfferData.gepEligibleBrandModel&&b.hide("buyBackVerifyIMEIText");else if("BLOCK"===a)c.increment("BuyBack:web:imeiBlock:count"),y(),h("#buyBackIMEITextInput").addClass("a-form-error"),
b.show("buybackImeiBlockAlert","buyBackVerifyIMEIText"),b.hide("buyBackTermsAndConditions","buyBackServiceFailedAlert","buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackIMEIMismatchAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),f.selectedBuyBackOfferData.gepEligibleBrandModel&&b.hide("buyBackVerifyIMEIText");else if("SUCCESS"===a)if(c.increment("BuyBack:web:correctIMEI:count"),b.hide("buyBackHowToGetIMEI","buyBackVerifyIMEIText","buyBackGEPIMEIInfoAlert","buyBackGetImeiGEP","buyBackIMEIMismatchAlert",
"buyBackValidIMEIAlert","buyBackServiceFailedAlert","buybackImeiBlockAlert","buyBackGEPNotEligibleAlert","buyBackGEPSuccessNotes"),b.show("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal","buyBackIMEIUpdate"),b.hide("buyBackApplyButton"),I(),C(),f.selectedBuyBackOfferData.gepEligibleBrandModel)if(k.showGEPDivPostIMEIValidation(f),f.gepDiscountValue&&f.gepSuccessNoteText){w.log("setPriceWithGEPOffer");a=f.buyBoxOfferBuyingPrice-f.gepDiscountValue;if(""===f.convenienceFee)E();
else{var d=Number(f.convenienceFee);a+=d;h("#isBuyBackFee")[0]===l?F():J();h("#convenienceFeeCharge").text(d);h("#convenienceFeeChargeModal").text(d)}a=b.getFormattedPrice(a);0<f.gepDiscountValue?b.show("buyBackOfferAppliedSuccess","buyBackOfferAppliedSuccessText"):b.hide("buyBackOfferAppliedSuccess","buyBackOfferAppliedSuccessText");6!==f.gepStatusCode?(h("#priceAfterBuyBackDiscount").text(a),h("#buyBackDiscountPrice").text(b.getFormattedPrice(f.gepDiscountValue)),h("#buyBackDiscountPriceInsideAccordion").text(b.getFormattedPrice(f.gepDiscountValue)),
b.show("gepOfferAppliedSuccessText")):b.hide("buyBackGEPIMEISuccessAlert");b.hide("maxBuyBackDiscountSection","buyBackSponsoredDiscountText");b.show("priceAfterBuyBackDiscountSection")}else e.trigger(v.SET_PRICE_WITH_BUYBACK_OFFER,{hasValueCommensurateOffers:!1});else 11===f.gepStatusCode?(c.increment("BuyBack:GEP:gepNotEligibleDueToCustomerNotLoggedIn:count"),h("#buyBackGEPNotEligibleAlert").html(f.gepFailureNoteText),b.hide("buyBackGEPIMEISuccessAlert"),b.show("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess",
"buyBackTermsAndConditions")):(b.hide("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess"),b.show("buyBackTermsAndConditions"))}else h("#buyBackIMEITextInput").addClass("a-form-error"),b.hide("buyBackGEPNotEligibleAlert","buyBackOfferAppliedSuccess","buyBackIMEIUpdate","buyBackTermsAndConditions","buyBackServiceFailedAlert","buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),b.show("buyBackValidIMEIAlert","buyBackHowToGetIMEI","buyBackVerifyIMEIText"),f.selectedBuyBackOfferData.gepEligibleBrandModel&&
(b.show("buyBackGEPIMEIInfoAlert","buyBackGetImeiGEP"),b.hide("buyBackVerifyIMEIText","buyBackGEPNotEligibleAlert")),y()});h("#applyBuyBack").unbind("click").click(function(){f.vcExperimentalWebalbAllocation!==T.T1||f.selectedBuyBackOfferData.gepEligibleBrandModel?e.trigger(v.APPLY_EXCHANGE_BUTTON_EXECUTION,{hasValueCommensurateOffers:!1}):e.trigger(v.APPLY_EXCHANGE_BUTTON_CLICKED)});h("#cancelBuyBack").unbind("click").click(function(){q.callBBPageState&&q.getUpdatedState();b.auiNewPageStateParseLogicBuyBack();
u.lazyLoad();O();q.getUpdatedState();W();z();ea();h("#buyBackDropDown2").removeClass("hide");h("#buyBackDropDowns2").html("");h("#buyBackDropDown3").removeClass("hide");h("#buyBackDropDowns3").html("");h("#buyBackIMEITextInput").removeClass("a-form-error");h("#buyBackIMEITextInput").val("");fa();e.trigger(S.INITIALISE_VALUE_COMMENSURATE_DATA);X()})}function z(){var a=h("#buyBackDropDown0").val();"undefined"!==typeof a&&""!==a&&x("buyBackDropDown0");a=h("#buyBackDropDown1").val();if("undefined"!==
typeof a&&""!==a){var d=h('[id\x3d"'+a+'"]').val();x("buyBackDropDown1");"undefined"!==typeof d&&""!==d&&(x(a),x(a+d))}}function Y(a,d,b,f,c){if("undefined"===typeof d)return"";var e="\x3cspan class\x3d'a-dropdown-container'\x3e\x3cselect name\x3d'"+f+b+"' id\x3d'"+f+b+"' tabindex\x3d'-1' class\x3d'a-native-dropdown a-button-span5 a-spacing-none'\x3e\x3coption class\x3d'a-prompt' value\x3d''\x3e"+c+"\x3c/option\x3e";h.each(d,function(a,d){e=e+"\x3coption value\x3d'"+d.header+"'\x3e"+d.header+"\x3c/option\x3e"});
return e=e+"\x3c/select\x3e\x3cspan tabindex\x3d'-1' id\x3d'"+f+b+"Id' class\x3d'a-button a-button-dropdown a-spacing-none a-button-span5 hide' \x3e\x3cspan class\x3d'a-button-inner'\x3e\x3cspan class\x3d'a-button-text a-declarative' data-action\x3d'a-dropdown-button' role\x3d'button' tabindex\x3d'0'\x3e\x3cspan class\x3d'a-dropdown-prompt'\x3e"+c+"\x3c/span\x3e\x3c/span\x3e\x3ci class\x3d'a-icon a-icon-dropdown'\x3e\x3c/i\x3e\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e"}function P(){if("undefined"!==
typeof f.buyBackExchangeItems){var a="",d="";h.each(f.buyBackExchangeItems,function(b,c){a+=Y(b,c.containedBuyBackProductNodes,c.header,"",f.buyBackprompt2Text);var e=c.header;h.each(c.containedBuyBackProductNodes,function(a,b){d+=Y(a,b.containedBuyBackProductNodes,b.header,e,f.buyBackprompt3Text)})});h("#buyBackDropDowns2").html(a);h("#buyBackDropDowns3").html(d)}}function R(){if("undefined"!==typeof f.buyBackExchangeItems&&""!==f.buyBackExchangeItems){g.getSelect("buyBackDropDown1").getOptions().remove();
g.getSelect("buyBackDropDown1").addOptions(ja(f.buyBackExchangeItems));var a=f.buyBackprompt1Text;g.getSelect("buyBackDropDown1").update({option_prompt:a});m.when("A").execute(function(a){a.$("#buyBackDropDown1Id").show()});b.show("buyBackDropDown1Id","buyBackDropDowns1");1<f.noOfQuestions&&P()}}function ka(){e.trigger(v.RESET_ACCORDION_CONTENT);c.increment("BuyBack:web:dropDown0Select:count");c.startTimer("BuyBack:web:getBuyBackCrossCategoryOffers");b.hide("buyBackSelectDropDown2Alert","buyBackDropDown2",
"buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown3","buyBackValidIMEIAlert","buyBackIMEIUpdate","buyBackMobileWorkingConditionText","mobileExchangeNotAvailableAtPincode","buyBackItemWorkingConditionText","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection");b.show("buyBackCollectOldProductDetailsText","maxBuyBackDiscountSection");f.categoryChosen=
h("#buyBackDropDown0").val();G();f.selectedBuyBackOptions=["","",""];f.previousSelectedBuyBackOptions=["",""];var a=b.updateBestBuyBackOfferForCategory(f);""===f.buyBackExchangeItems||!1===a?(c.increment("BuyBack:web:crossCategoryOfferNotAvailableStringShown:count"),c.startTimer("BuyBack:web:crossCategoryOfferNotAvailable"),f.buyBackExchangeItems="",b.hide("buyBackDropDowns1","buyBackDropDowns2","buyBackDropDowns3","buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection",
"buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown1Id","buyBackCollectOldProductDetailsText","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection"),b.hide("buyBackCollectOldProductDetailsText","chooseButton"),b.show("mobileExchangeNotAvailableAtPincode"),y(),c.stopTimer("BuyBack:web:crossCategoryOfferNotAvailable")):(document.getElementById("buyBackDropDown0Id").classList.contains("a-button-span6")&&
(document.getElementById("buyBackDropDown0Id").classList.remove("a-button-span6"),document.getElementById("buyBackDropDown0Id").classList.add("a-button-span5")),h(".dropDownChosen").each(function(){h(this).addClass("hide")}),b.hide("buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal"),f.categoryChosen.toLowerCase()===f.buyBackMobile&&(b.hide("buyBackDropDown3"),b.show("buyBackMobileWorkingConditionText")),"tv"===f.categoryChosen.toLowerCase()&&b.show("buyBackItemWorkingConditionText"),
g.getSelect("buyBackDropDown1").update({option_prompt:f.buyBackprompt1Text}),c.stopTimer("BuyBack:web:getBuyBackCrossCategoryOffers"),e.trigger(S.INITIALISE_VALUE_COMMENSURATE_DATA),e.trigger(v.UPDATE_BUYBACK_MODAL_HEIGHT))}function ia(){var a=""===f.categoryChosen.toLowerCase()?f.productCategory:f.categoryChosen.toLowerCase();a!==l&&""!==a&&(a=la[a],a!==l&&""!==a&&(a={inlineContent:a,position:"triggerBottom"},e.declarative.create(h("#refImages"),"a-tooltip",a)))}function ja(a){var d=[];e.each(a,
function(a){d.push({text:a.header,value:a.header})});return d}function V(){e.on("a:dropdown:select",function(a){"buyBackDropDown0"===a.name&&(ka(),""!==f.buyBackExchangeItems&&R())})}function ha(){W();z();ea();fa();X()}function fa(){R();var a=document.getElementById("buyBackDropDown0");f.crossCategoryOfferAvailable!==l&&null!==a&&"true"===f.crossCategoryOfferAvailable&&(b.hide("buyBackDropDown1Id","buyBackDropDowns1","buyBackDropDown2","buyBackDropDown3"),document.getElementById("buyBackDropDown0Id").classList.contains("a-button-span5")&&
(document.getElementById("buyBackDropDown0Id").classList.remove("a-button-span5"),document.getElementById("buyBackDropDown0Id").classList.add("a-button-span6")))}function ea(){b.hide("buyBackIMEISection","buyBackBuyNowButton","bbAppliedState","priceAfterBuyBackDiscountSection","buyBackConvenienceFeeTextSection","buyBackTermsAndConditions","buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal","buyBackDropDown2","buyBackDropDown3");b.show("maxBuyBackDiscountSection");h(".dropDownChosen").each(function(){h(this).addClass("hide")})}
function X(){var d=a.get("BuyBackModalDialog");d!==l&&null!==d&&""!==d&&d.hide()}function W(){b.hide("buyBackBuyNowButton","bbAppliedState","priceAfterBuyBackDiscountSection","buyBackTermsAndConditions","buyBackOfferAppliedSuccessText1",B.DISCOUNT_PRICE_INSIDE_ACCORDION_TEXT,"buyBackGEPIMEIInfoAlert","buyBackGetImeiGEP","buyBackGEPIMEISuccessAlert","gepOfferAppliedSuccessText","buyBackGEPNotEligibleAlert","buyBackIMEIUpdate","buyBackOfferAppliedSuccessText","gepOfferAppliedSuccessText","buyBackGEPSuccessNotes");
b.show("maxBuyBackDiscountSection");f.gepEligible&&b.show("gepEligibleText");n("#chooseButton").text(aa);b.hide("buyBackConvenienceFeeTextSection");y();b.hide("buyBackBuyNowButton")}var h=e.$,f={selectedBuyBackOptions:["","",""],previousSelectedBuyBackOptions:["",""],imeiNumber:"",totalSponsoredValue:0,shouldDisplaySponsorMessage:"1",purchaseHistoryDiscount:0,categoryChosen:"",productCategoryToDbMapping:{tv:"TV",refrigerator:"Refrigerator",laptop:"Laptop",washingmachine:"WashingMachine",tablet:"Tablet",
ac:"AC"},bulkyCategories:"tv washingmachine refrigerator ac sofa coffeetable mattress wardrobe recliner shoerack tvunit studytable officechair bed".split(" ")},v=p.action,L=p.selectors,Q=p.common,T=d.treatment,S=A.action,ba=A.common,B=A.selector,aa,da=h("#"+L.MODAL_LEFT_COLUMN_CONTENT),U=h("#"+L.MODAL_LEFT_COLUMN),ca=h("#"+L.MODAL_RIGHT_COLUMN),la={mobile:"\x3cimg src\x3d'https://m.media-amazon.com/images/G/31/buyback/device_check_screen/Mobile/NON_VC/2.jpg' height\x3d'135' width\x3d'135' /\x3e\x26nbsp; \x26nbsp;\x3cimg src\x3d'https://m.media-amazon.com/images/G/31/buyback/device_check_screen/Mobile/NON_VC/3.jpg' height\x3d'135' width\x3d'135' /\x3e\x3c/br\x3e\x3c/br\x3e\x3cimg src\x3d'https://m.media-amazon.com/images/G/31/buyback/device_check_screen/Mobile/NON_VC/4.jpg' height\x3d'135' width\x3d'135' /\x3e\x26nbsp; \x26nbsp;\x3cimg src\x3d'https://m.media-amazon.com/images/G/31/buyback/device_check_screen/Mobile/NON_VC/1.jpg' height\x3d'135' width\x3d'135' /\x3e"};
e.on("a:accordion:buybox-accordion:buyBackAccordionRow:select",function(a){c.increment("BuyBack:web:buyBackAccordionRow:select:count");h=e.$;a=document.getElementById("buyBackDropDown0");var d=f.crossCategoryOfferAvailable;"true"===d&&(b.hide("buyBackIMEISection","buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal"),b.hide("buyBackDropDown1Id","buyBackDropDowns1","buyBackDropDown2","buyBackDropDown3"),g.getSelect(h('[id\x3d"buyBackDropDown0"]')).setValue(""),h(".dropDownChosen").each(function(){h(this).addClass("hide")}),
h("#buyBackDropDowns2").html(""),h("#buyBackDropDowns3").html(""),h("#buyBackIMEITextInput").removeClass("a-form-error"),h("#buyBackIMEITextInput").val(""));O();var p=h("#isSlotsAvailable").attr("value");-1<f.bulkyCategories.indexOf(f.buyBackCategory.toLowerCase())&&p!==l&&"false"===p?(c.increment("BuyBack:web:hnbFaddBuyBackSuppression:count"),c.startTimer("BuyBack:web:hnbFaddBuyBackSuppression"),h("#buyBackDropDowns3").parent().addClass("aok-hidden"),h("#buyBackDropDown0").parent().parent().addClass("aok-hidden"),
b.hide("maxBuyBackDiscountSection","buyBackDropDowns1","buyBackSelectDropDown2Alert","buyBackDropDown2","buyBackOfferAppliedSuccess","buyBackIMEISection","buyBackDetailsVerifyText","buyBackTermsAndConditions","priceAfterBuyBackDiscountSection","buyBackServiceFailedAlert","buyBackIMEIMismatchAlert","buyBackDropDown1Id","buyBackCollectOldProductDetailsText","buybackImeiBlockAlert","buyBackConvenienceFeeTextSection","chooseButton"),b.show("mobileExchangeNotAvailableAtPincode"),n("#buyBackBuyNowButton").disable(),
c.stopTimer("BuyBack:web:hnbFaddBuyBackSuppression")):(d!==l&&null!==a&&"false"===f.crossCategoryOfferAvailable&&(c.increment("BuyBack:web:mobileOffersNotAvailable:count"),f.productCategory.toLowerCase()!==f.categoryChosen.toLowerCase()&&(f.buybackCategory=f.productCategory,f.categoryChosen=f.productCategoryToDbMapping[f.productCategory],b.updateBestBuyBackOfferForCategory(f),1<f.noOfQuestions&&P()),b.hide("buyBackDropDowns0SectionId","buyBackDropDown0Id","buyBackDropDown0","buyBackDropDown1","buyBackDropDown2",
"buyBackDropDown3","mobileExchangeNotAvailableAtPincode","buyBackIMEISection"),b.show("buyBackDropDown1","buyBackDropDown1Id","buyBackDropDowns1")),f.gepEligible&&b.show("gepEligibleText"))});e.on("a2i_dpx:buyback:processBBPageState",function(){q.callBBPageState&&q.getUpdatedState();b.auiNewPageStateParseLogicBuyBack();u.lazyLoad();O();V();R();1<f.noOfQuestions&&P();f.gepEligible&&b.show("gepEligibleText");H()});z();O();V();1<f.noOfQuestions&&P();H();e.on(v.APPLY_EXCHANGE_BUTTON_EXECUTION,function(a){var d=
!1;a!==l&&(d=a.hasValueCommensurateOffers);b.show("buyBackBuyNowButton","bbAppliedState","priceAfterBuyBackDiscountSection","buyBackTermsAndConditions");d?(b.show(B.DISCOUNT_PRICE_INSIDE_ACCORDION_TEXT),b.hide("buyBackOfferAppliedSuccessText1")):(b.hide(B.DISCOUNT_PRICE_INSIDE_ACCORDION_TEXT),b.show("buyBackOfferAppliedSuccessText1"));b.hide("maxBuyBackDiscountSection","gepEligibleText");a=f.selectedBuyBackOptions[0]+" "+f.selectedBuyBackOptions[1];n("#chooseButton").text(a);""!==f.convenienceFee&&
b.show("buyBackConvenienceFeeTextSection");X();C()});e.on(v.UPDATE_BUYBACK_MODAL_HEIGHT,function(){I()});e.on(v.BUYBACK_OFFER_SUCCESSFULLY_APPLIED,function(a){Z(a)});e.on(v.SET_PRICE_WITH_BUYBACK_OFFER,function(a){w.log("setPriceWithBuyBackOffer");if(a!==l&&!0===a.hasValueCommensurateOffers)a=f.buyBoxOfferBuyingPrice-a.valueCommensurateTotalDiscount;else{var d=(1===f.shouldReduceBuyBackDiscount?b.roundToNearestTen(f.selectedBuyBackOfferData.discountPrice*ba.BASE_BUYBACK_DISCOUNT_REDUCTION_PERCENTAGE):
f.selectedBuyBackOfferData.discountPrice)+f.totalSponsoredValue+f.purchaseHistoryDiscount;a=f.buyBoxOfferBuyingPrice-d;k.updateBuyBackDiscountDivsForGepEligibleBrandModel(f,d)}""===f.convenienceFee?E():(d=Number(f.convenienceFee),a+=d,h("#isBuyBackFee")[0]===l?F():J(),h("#convenienceFeeCharge").text(d),h("#convenienceFeeChargeModal").text(d));a=b.getFormattedPrice(a);h("#priceAfterBuyBackDiscount").text(a);e.trigger(v.SHOW_BUYBACK_POST_OFFER_SELECTION_EXPERIENCE)});e.on(v.SHOW_BUYBACK_POST_OFFER_SELECTION_EXPERIENCE,
function(){f.buyBackCategory.toLowerCase()!==f.buyBackMobile.toLowerCase()?(C(),b.show("buyBackApplyOrCancelButtons","buyBackConvenienceFeeTextSectionModal")):(b.show("buyBackIMEISection","buyBackVerifyIMEIText"),b.hide("buyBackTermsAndConditions"),f.selectedBuyBackOfferData.gepEligibleBrandModel&&b.hide("buyBackVerifyIMEIText"));e.trigger(v.UPDATE_BUYBACK_MODAL_HEIGHT);c.increment("BuyBack:web:dataSaveSuccess:count")});e.on(v.SHOW_BUYBACK_IMEI_CONTENT,function(){b.hide("successIcon","buyBackGEPIMEIInfoAlert",
"buyBackGetImeiGEP");b.show("buyBackHowToGetIMEI","buyBackIMEISection","buyBackDetailsVerifyText","buyBackVerifyIMEIText","buyBackApplyButton");f.selectedBuyBackOfferData.gepEligibleBrandModel&&(b.show("buyBackGEPIMEIInfoAlert","buyBackGetImeiGEP"),b.hide("buyBackDetailsVerifyText"))});e.on(v.HIDE_BUYBACK_IMEI_CONTENT,function(){b.hide("buyBackDropDown3","buyBackIMEIMismatchAlert","buyBackValidIMEIAlert","buyBackIMEIUpdateText","buyBackCollectOldProductDetailsText","buybackImeiBlockAlert","buyBackHowToGetIMEI",
"buyBackIMEISection");h("#buyBackIMEITextInput").removeClass("a-form-error");h("#buyBackIMEITextInput").val("")});e.on(v.PAGE_UPDATE,function(){w.log(v.PAGE_UPDATE);da=h("#"+L.MODAL_LEFT_COLUMN_CONTENT);U=h("#"+L.MODAL_LEFT_COLUMN);ca=h("#"+L.MODAL_RIGHT_COLUMN)});e.on(v.RESET_ACCORDION_CONTENT,function(){w.log(v.RESET_ACCORDION_CONTENT);W()});t.addEventListener(v.UNLOAD_PAGE,function(a){t.event&&40>t.event.clientX&&0>t.event.clientY?z():1===a.currentTarget.performance.navigation.type?ha():2===a.currentTarget.performance.navigation.type&&
ha()})});"use strict";m.when("A","BBPageState","bbMetric","buyBackConstants","BBPageStateHelper").register("buyback-util",function(e,n,g,b,q){function c(a){var b=a%10;10<=a&&(b+=c(Math.floor(a/10)));return b}var k=e.$,m=b.common;n.init();var t=n.getUpdatedState();return{hide:function(){for(var a=0;a<arguments.length;a++)k("#"+arguments[a]).removeClass("show").addClass("hide")},show:function(){for(var a=0;a<arguments.length;a++)k("#"+arguments[a]).removeClass("hide").addClass("show")},hideAll:function(){for(var a=
0;a<arguments.length;a++)for(var b=arguments[a],d=0;d<b.length;d++)k(b[d]).removeClass("show").addClass("hide")},showAll:function(){for(var a=0;a<arguments.length;a++)for(var b=arguments[a],d=0;d<b.length;d++)k(b[d]).removeClass("hide").addClass("show")},hideInline:function(){for(var a=0;a<arguments.length;a++)null!==k("#"+arguments[a])&&k("#"+arguments[a]).addClass("hide")},showInline:function(){for(var a=0;a<arguments.length;a++)null!==k("#"+arguments[a])&&k("#"+arguments[a]).removeClass("hide")},
isValidBuyBackIMEI:function(){var a=k("#buyBackIMEITextInput").val(),b=0;if(15!==a.length||-1!==a.indexOf("."))return!1;a=Number(k("#buyBackIMEITextInput").val());if(isNaN(a))return!1;for(var d=15;1<=d;d--){var e=a%10;0===d%2&&(e*=2);b+=c(e);a=Math.floor(a/10)}return 0===b%10?!0:!1},getFormattedPrice:function(a,b){"undefined"===typeof b&&(b=!1);a=a.toFixed(2);var d=Math.floor(a),c="";b?0<a.indexOf(".")&&d!==a&&(c=a.substring(a.indexOf("."),a.length)):0<a.indexOf(".")&&(c=a.substring(a.indexOf("."),
a.length));d=d.toString();a=d.substring(d.length-3);d=d.substring(0,d.length-3);""!==d&&(a=","+a);return d.replace(/\B(?=(\d{2})+(?!\d))/g,",")+a+c},applyBuyBackOffer:function(a){var b=!1,d={type:"post",url:"/gp/product/features/buyback/buyBackDiscountHandler.html?"+k.param({asin:a.asin,category:a.buyBackCategory,currencyCode:a.currencyCode,postalCode:a.postalCode,sellerId:a.sellerId,categoryIdentifier:a.categoryIdentifier,productPrice:a.buyBoxOfferBuyingPrice,buyBackOfferId:a.selectedBuyBackOfferData.offerId,
isGepEligible:a.selectedBuyBackOfferData.gepEligibleBrandModel?1:0,discountValue:a.selectedBuyBackOfferData.discountPrice||(a.selectedBuyBackOfferData.gepEligibleBrandModel?1:0),feeAsin:a.feeAsin,convenienceFee:a.convenienceFee,valueCommensurateRequestId:a.valueCommensurateRequestId===l||a.selectedBuyBackOfferData.gepEligibleBrandModel?"":a.valueCommensurateRequestId,executingFeature:a.executingFeature!==l?a.executingFeature:"",deviceType:a.deviceType!==l?a.deviceType:""}),async:!1,success:function(d){try{var c=
JSON.parse(d)}catch(w){b=!1}"undefined"!==typeof c&&"SUCCESS"===c.status&&(b=!0,a.totalSponsoredValue=c.sponsoredDiscount,a.purchaseHistoryDiscount=c.purchaseHistoryDiscount,a.shouldDisplaySponsorMessage=c.shouldDisplaySponsorMessage,a.isValueCommensurateEligible=c.isValueCommensurateEligible,a.shouldReduceBuyBackDiscount=c.shouldReduceBuyBackDiscount,e.state("AdditionalSweetener",{sweetener:c.valueMatchingSweetener}))},error:function(){b=!1}};k.ajax(d);e.trigger("BUYBACK_DISCOUNT_HANDLER_FOR_DFL",
b);return b},updateBestBuyBackOfferForCategory:function(a){var b=!1,d={type:"post",url:"/gp/product/features/buyback/buyBackOffersForCategory.html?"+k.param({encryptedMarketPlaceId:a.encryptedMarketPlaceId,asin:a.asin,productPrice:a.productPrice,brand:a.brand,subCategoryName:a.subCategoryName,encryptedMerchantId:a.sellerId,postalCode:a.postalCode,buyBackCategory:a.categoryChosen,rbnHierarchyNodes:a.productCategory}),async:!1,success:function(d){try{var c=JSON.parse(d)}catch(w){b=!1}"undefined"!==
typeof c&&"SERVICE-SUCCESS"===c.status&&(b=!0,a.buyBackExchangeItems="",""!==c.BestBuyBackOffer&&null!==c.BestBuyBackOffer&&(d=JSON.parse(c.BestBuyBackOffer),a.buyBackExchangeItems=d.containedBuyBackProductNodes),a.buyBackCategory=c.BuyBackCategory,a.buyBackprompt1Text=c.Option1PromptText,a.buyBackprompt2Text=c.Option2PromptText,a.buyBackprompt3Text=c.Option3PromptText)},error:function(){b=!1}};k.ajax(d);return b},validateBrandAndModelBasedOnIMEI:function(a){var b={asin:a.asin,imeiNumber:a.imeiNumber,
brand:a.selectedBuyBackOptions[0],model:a.selectedBuyBackOptions[1],category:a.buyBackCategory.toLowerCase(),sellerId:a.sellerId,isGepEligible:a.selectedBuyBackOfferData.gepEligibleBrandModel?1:0,totalBuyBackDiscount:a.selectedBuyBackOfferData.discountPrice+a.totalSponsoredValue,productPrice:a.productPrice,executingFeature:a.executingFeature!==l?a.executingFeature:"",deviceType:a.deviceType!==l?a.deviceType:"",valueCommensurateRequestId:1===a.isValueCommensurateEligible?a.valueCommensurateRequestId:
""},d="FAILED";b={type:"post",url:"/gp/product/features/buyback/verifyIMEIHandler.html?"+k.param(b),async:!1,success:function(b){try{var c=JSON.parse(b)}catch(w){d="FAILED"}"undefined"!==typeof c&&"SUCCESS"===c.status?(d="SUCCESS",a.gepDiscountValue=c.gepDiscountValue,a.discountAppliedText=c.discountAppliedText,a.gepSuccessNoteText=c.gepSuccessNoteText,a.gepFailureNoteText=c.gepFailureNoteText,a.gepStatusCode=c.gepStatusCode):"undefined"!==typeof c&&"MISMATCH"===c.status?d="MISMATCH":"undefined"!==
typeof c&&"BLOCK"===c.status&&(d="BLOCK")},error:function(){d="FAILED"}};k.ajax(b);e.trigger("IMEI_AJAX_CALL_VERIFICATION",d,a);e.trigger("VALIDATE_IMEI_FOR_DFL",d,a);return d},setSelectedBuyBackOffer:function(a){var b=!0;k.each(a.buyBackExchangeItems,function(d,c){if(1<a.noOfQuestions&&c.header===a.selectedBuyBackOptions[0])k.each(c.containedBuyBackProductNodes,function(d,c){if(c.header===a.selectedBuyBackOptions[1]){if(""===a.selectedBuyBackOptions[2]&&null!==c.buyBackProductDetails)return a.selectedBuyBackOfferData=
c.buyBackProductDetails.buyBackOfferDetailsList[0],b=!1;k.each(c.containedBuyBackProductNodes,function(d,c){if(c.header===a.selectedBuyBackOptions[2]&&null!==c.buyBackProductDetails)return a.selectedBuyBackOfferData=c.buyBackProductDetails.buyBackOfferDetailsList[0],b=!1})}});else if(1===a.noOfQuestions&&c.header===a.selectedBuyBackOptions[0]){if(null!==c.buyBackProductDetails)return a.selectedBuyBackOfferData=c.buyBackProductDetails.buyBackOfferDetailsList[0],b=!1;k.each(c.containedBuyBackProductNodes,
function(d,c){if(c.header===a.selectedBuyBackOptions[2]&&null!==c.buyBackProductDetails)return a.selectedBuyBackOfferData=c.buyBackProductDetails.buyBackOfferDetailsList[0],b=!1})}return b});return b},auiNewPageStateParseLogicBuyBack:function(){var a=e.parseJSON,b=["buyBackPageState"];e.each(k('script[type\x3d"a-state"]'),function(d){d=k(d);if(!d.data("a-eval")){var c=d.attr("data-a-state");if(c&&(c=a(c),c.key&&-1!==k.inArray(c.key,b))){var g=a(d.html());e.state.replace(c.key,g);d.data("a-eval",!0)}}})},
getSponsoredDiscount:function(a,b,d,c,e){var p=0;a={type:"post",url:"/gp/product/features/buyback/buyBackAjaxHandler.html?"+k.param({asin:a.asin,category:a.buyBackCategory,currencyCode:a.currencyCode,postalCode:a.buyBackPostalCode,sellerId:a.sellerId,categoryIdentifier:a.categoryIdentifier,productPrice:a.buyBoxOfferBuyingPrice,buyBackOfferId:b,discountValue:d,imeiNumber:c,brand:a.deviceBrandName,modelId:a.deviceModelId,feeAsin:a.feeAsin,convenienceFee:a.convenienceFee}),async:!1,success:function(a){try{var d=
JSON.parse(a)}catch(Z){p=0}"undefined"!==typeof d&&"SUCCESS"===d.status&&(p=d.sponsoredDiscount,e.shouldDisplaySponsorMessage=d.shouldDisplaySponsorMessage)},error:function(){p=0}};k.ajax(a);return p},getMaxDiagnosticsDiscount:function(a,b){a="/gp/product/features/buyback/buyBackDiagnosticOffer.html?"+k.param({sessionId:a.dpSessionId,asin:a.asin,diagnosticRunId:b,productPrice:a.buyBoxOfferBuyingPrice});var d=0;if(!b||0===b.length)return d;k.ajax({type:"post",url:a,async:!1,success:function(a){try{var b=
JSON.parse(a)}catch(w){d=0}"undefined"!==typeof b&&"SERVICE-SUCCESS"===b.status&&(d=b)},error:function(){d=0}});return d},getModelNameFromModelId:function(a,b){var d="";a={type:"post",url:"/gp/product/features/buyback/diagnosticMobileModelName.html?"+k.param({mobileModelId:b+"_"+a}),async:!1,success:function(a){try{var b=JSON.parse(a)}catch(w){d=""}"undefined"!==typeof b&&"SERVICE-SUCCESS"===b.status&&(d=b)},error:function(){d=""}};k.ajax(a);return d},updateCustomerdata:function(a,b,d,c){var e=!1;
a={type:"post",url:"/gp/product/features/buyback/updateBuyBackCustomerDataBySession.html?"+k.param({sessionId:a.dpSessionId,asin:a.asin,buyBackData:b,sponsoredOffers:d,diagnosticOffer:c}),async:!1,success:function(a){try{var d=JSON.parse(a)}catch(O){e=!1}"undefined"!==typeof d&&"SERVICE-SUCCESS"===d.status&&(e=!0)},error:function(){e=!1}};k.ajax(a);return e},fetchDeviceCheckRejectWeblabTreatment:function(){var a="C";k.ajax({type:"get",url:"/gp/product/features/buyback/buyBackDeviceCheckWeblabTrigger.html",
async:!1,success:function(b){try{var d=JSON.parse(b)}catch(p){g.increment("BuyBack:buyBackDeviceCheckWeblabTrigger:jsonParse:count")}"undefined"!==typeof d&&"SUCCESS"===d.status&&(a=d.deviceCheckRejectWeblab,g.increment("BuyBack:deviceCheckRejectWeblab:success:count"))},error:function(){g.increment("BuyBack:deviceCheckRejectWeblab:error:count")}});return a},checkBuyBackAccordionRequest:function(a){return"undefined"===typeof a||"BB"===a?!0:!1},checkValidDeviceCheckRequest:function(a,b,d){return"DFL"===
a||this.checkBuyBackAccordionRequest(a)&&b||d?!0:!1},checkDeviceCheckScreenAvailability:function(a,b){return"T1"!==a||"mobile"!==b&&"Mobile"!==b?!1:!0},setBuyBackDeviceCheckScreenImages:function(){var a=["https://m.media-amazon.com/images/G/31/buyback/device_check_screen/1.jpg","https://m.media-amazon.com/images/G/31/buyback/device_check_screen/2.jpg","https://m.media-amazon.com/images/G/31/buyback/device_check_screen/3.jpg","https://m.media-amazon.com/images/G/31/buyback/device_check_screen/4.jpg"];
if(null!==k(".device-check-image-container"))for(var b=k(".device-check-image-container").length,d=a.length,c=0;c<b;c++){var e=a[c%d],g=k(".device-check-image-container")[c].childNodes[1];null!==g&&null!==g.childNodes[1]&&g.childNodes[1].setAttribute("src",e)}},setBuyBackExchangeTip:function(a,b,d){if(this.checkValidDeviceCheckRequest(a,b,d)){a=localStorage.getItem("deviceCheckRejectWeblabTreatment");b=k("#buybackMobileExchangeTipT1Treatment");d=k("#buybackMobileExchangeTipT2Treatment");var c=k("#buybackMobileExchangeTip");
b&&d&&c&&("T1"===t.deviceCheckWeblabAllocation&&"T1"===a?(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment","buybackMobileExchangeTip"),this.show("buybackMobileExchangeTipT1Treatment"),this.setBuyBackDeviceCheckScreenImages()):"T1"===t.deviceCheckWeblabAllocation&&"T2"===a?(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment","buybackMobileExchangeTip"),this.show("buybackMobileExchangeTipT2Treatment"),this.setBuyBackDeviceCheckScreenImages()):
"T1"===t.deviceCheckWeblabAllocation&&(this.hide("buybackMobileExchangeTipT1Treatment","buybackMobileExchangeTipT2Treatment","buybackMobileExchangeTip"),this.show("buybackMobileExchangeTip")))}},convertAmountToIndianFormat:function(a){var b=parseInt(a);b=b.toString();a=b.substring(b.length-3);b=b.substring(0,b.length-3);""!==b&&(a=","+a);return b.replace(/\B(?=(\d{2})+(?!\d))/g,",")+a},updateBuyBackPageState:function(){t=n.getUpdatedState()},isEmptyObjectKey:function(a,b){return a.hasOwnProperty(b)&&
a[b]!==l&&a[b]!==m.EMPTY_STRING&&a[b]!==m.EMPTY_SPACE_STRING},loadPageState:function(){q.lazyLoad()},roundToNearestTen:function(a){var b=1;0>a&&(b=-1);return 10*b*Math.round(Math.abs(a)/10)},parseQueryString:function(a){var b={};a=a.split("\x26");for(var d=0;d<a.length;d++){var c=a[d].split("\x3d");b[decodeURIComponent(c[0])]=decodeURIComponent(c[1]||"")}return b}}});"use strict";m.when("A").register("DiagnosticsState",function(e){return{_isPhoneRooted:null,_isAutoDetectSuccessfull:null,_clickedAlready:!1,
_ranAutoDetection:!1,_ranPhoneRooted:!1,_imeiNumber:"",_deviceBrandName:"",_deviceModelName:"",_deviceModelId:"",_amazonAppVersion:"",_androidVersion:"",_hiddenRowHTML:"",_lastHiddenElem:null,_shouldRunAutoDetect:!0}});"use strict";m.when("A","a-button","buyback-util","bbMetric","BBPageState","DiagnosticsState","Logger","gep-util","buyBackConstants","buyBackPageStateStatic").register("DiagnosticsUtils",function(e,n,g,b,q,c,k,m,K){k.log("DiagnosticsUtils file");var a=e.$,r=K.vsxConstants;return{buyBackState:q.get(),
setupNonAutoDetectAccordionRowCallback:null,startDiagnosticsFlow:function(){k.log("startDiagnosticsFlow");"function"!==typeof submitDiagnosticsForm&&(document.getElementById("backUrl").value=t.location.href,document.getElementById("diagnosticsForm").submit())},getAndroidVersion:function(){k.log("getAndroidVersion");var a=navigator.userAgent.match(/Android[\/]*[\d\.]+/),b="0.0";null!==a&&null!==a[0]&&(a=a[0].split("/"),null!==a&&(b=a[1]));return parseFloat(b,10)},getAmazonAppVersion:function(){k.log("getAmazonAppVersion");
var a=navigator.userAgent.match(/Amazon.com[\/]*[\d\.]+/),b="0.0";null!==a&&null!==a[0]&&(a=a[0].split("/"),null!==a&&(b=a[1]));return parseFloat(b.split(".")[0]+"."+b.split(".")[1],10)},checkPhoneRootedAPI:function(){k.log("checkPhoneRootedAPI");t.cordova.require("cordova/exec")(this.phoneRootedCallbackSuccess.bind(this),this.phoneRootedCallbackError.bind(this),"MShopMobileAutoDiagnostic","isPhoneRooted",{})},runAutoDetectionAPI:function(){k.log("runAutoDetectionAPI");t.cordova.require("cordova/exec")(this.autoDetectCallback.bind(this),
this.autoDetectCallback.bind(this),"MShopMobileAutoDiagnostic","getAutoDetectPhoneInfo",{})},triggerAutoClick:function(){k.log("triggerAutoClick");var a=document.getElementById("buyBackAccordionRow");null!==a&&a!==l&&a.classList.contains("a-accordion-active")&&!1===c._clickedAlready&&(c._clickedAlready=!0,this.primaryAccordionClick())},triggerAutoClickAfterDiagnostics:function(){k.log("triggerAutoClickAfterDiagnostics");if("BB"===this.buyBackState.programName){b.increment("BuyBack:mobile:autoDiagnosticRunSuccess:count");
var d=a("#buyBackAccordionRow a.a-accordion-row");null!==d&&0<d.length&&a(d)[0].click()}},primaryAccordionClick:function(){k.log("primaryAccordionClick");g.hide("autoDetectionAccordion");g.hide("withAutoDetection-accordion","withoutAutoDetection-accordion");n("#buyBackBuyNowButton").disable();g.hide("buyBackConfirmButton");if("BB"===this.buyBackState.programName){a("#autoDetectionAccordion").show();this.setHiddenRowInElement(a("#withoutAutoDetection-accordion .a-accordion-inner"));var b=a("#withAutoDetection-accordion a.a-accordion-row");
g.show("withAutoDetection-accordion","withoutAutoDetection-accordion");null!==b&&0<b.length&&a(b)[0].click();a("#diagnosticsSpinnerDiv").hide();g.show("autoDetectionAccordion")}else this.runAutoDetection()},runAutoDetection:function(){k.log("runAutoDetection");c._androidVersion=this.getAndroidVersion();c._amazonAppVersion=this.getAmazonAppVersion();5>c._androidVersion?b.increment("BuyBack:mobile:autoDetectionFailedOldAppAndroid:count"):12.7>c._amazonAppVersion?b.increment("BuyBack:mobile:autoDetectionFailedOldAppAmazon:count"):
m.isGEPEligibleCustomer(this.buyBackState)?(b.increment("BuyBack:mobile:autoDetectionSkippedGEPCustomer:count"),c._shouldRunAutoDetect=!1,this.showAutoDetectionResult()):(a("#diagnosticsSpinnerDiv").show(),g.hide("autoDetectionAccordion"),this.checkPhoneRootedAPI(),this.runAutoDetectionAPI())},addAutoDetectDataToState:function(){k.log("addAutoDetectDataToState");this.buyBackState.imeiNumber=c._imeiNumber;this.buyBackState.deviceBrandName=c._deviceBrandName;this.buyBackState.deviceModelName=c._deviceModelName;
this.buyBackState.deviceModelId=c._deviceModelId;q._buyBackState=this.buyBackState},showAutoDetectionResult:function(){k.log("showAutoDetectionResult");if(c._shouldRunAutoDetect&&(!1===c._ranPhoneRooted||!1===c._ranAutoDetection))return!1;a("#diagnosticsSpinnerDiv").hide();g.show("autoDetectionAccordion");if(!1===c._shouldRunAutoDetect||!1===c._isAutoDetectSuccessfull||!0===c._isPhoneRooted)a("#buybackAccordion").remove(),this.setHiddenRowInElement(a("#hidden-accordion-content")),a("#hidden-accordion-content").removeClass("aok-hidden");
else{b.increment("BuyBack:mobile:autoDetectionShown:count");this.setHiddenRowInElement(a("#withoutAutoDetection-accordion .a-accordion-inner"));var d=a("#withAutoDetection-accordion a.a-accordion-row");g.show("withAutoDetection-accordion","withoutAutoDetection-accordion");this.addAutoDetectDataToState();this.buyBackState.executingFeature!==l&&this.buyBackState.executingFeature===r.EXECUTING_FEATURE_NAME_VSX&&this.autoDetectionDeviceDetails();null!==d&&0<d.length&&a(d)[0].click()}},autoDetectionDeviceDetails:function(){var a=
{};a[r.DEVICE_BRAND]=c._deviceBrandName;a[r.DEVICE_MODEL]=c._deviceModelName;return a},setHiddenRowInElement:function(b){k.log("setHiddenRowInElement");var d=!1;this.buyBackState.executingFeature!==l&&this.buyBackState.executingFeature===r.EXECUTING_FEATURE_NAME_VSX&&(d=!0);if(this.buyBackState.dflEligible&&!d&&null!==c._lastHiddenElem&&0===a("#hidden-accordion-content").html().length)return!1;k.log("setHiddenRowInElement:"+b.selector);a("#hidden-accordion-content").html("");c._lastHiddenElem=b;b.html(c._hiddenRowHTML);
g.setBuyBackExchangeTip("BB",this.buyBackState.dflEligible,d);this.setupNonAutoDetectAccordionRowCallback()},autoDetectCallback:function(a){k.log("autoDetectCallback");var d=!1;if(null===a.model||a.model===l)b.increment("BuyBack:mobile:autoDetectionFailedAPI:count"),k.log("BuyBack:mobile:autoDetectionFailedAPI:count"),d=!0;if(!d){var e=g.getModelNameFromModelId(a.model,a.brand).MobileModelName;null===e||e===l||""===e?(b.increment("BuyBack:mobile:autoDetectionFailedModel:count"),k.log("BuyBack:mobile:autoDetectionFailedModel:count"),
d=!0):null===a.imeiNumber||a.imeiNumber===l||""===a.imeiNumber?(b.increment("BuyBack:mobile:autoDetectionFailedIMEI:count"),k.log("BuyBack:mobile:autoDetectionFailedIMEI:count"),d=!0):(c._imeiNumber=a.imeiNumber,c._deviceBrandName=a.brand,c._deviceModelName=e,c._deviceModelId=a.model)}d||(a=this.setAutoDetectDiscount(c._deviceBrandName,c._deviceModelName),null!==a&&a!==l&&0!==a.discount)||(b.increment("BuyBack:mobile:autoDetectionFailedDiscount:count"),k.log("BuyBack:mobile:autoDetectionFailedDiscount:count"),
d=!0);c._ranAutoDetection=!0;c._isAutoDetectSuccessfull=!d;this.showAutoDetectionResult()},phoneRootedCallbackSuccess:function(a){k.log("phoneRootedCallbackSuccess");"true"===a.rootedStatus?(b.increment("BuyBack:mobile:autoDetectionFailedRooted:count"),c._isPhoneRooted=!0):c._isPhoneRooted=!1;c._ranPhoneRooted=!0;this.showAutoDetectionResult()},phoneRootedCallbackError:function(a){k.log("phoneRootedCallbackError");c._isPhoneRooted=!1;c._ranPhoneRooted=!0;b.increment("BuyBack:mobile:phoneRootedAPIFailed:count");
this.showAutoDetectionResult()},bindDiagnosticsFunctionality:function(d,p,l){k.log("bindDiagnosticsFunctionality");this.buyBackState=!p||l?q.getUpdatedState():q.get();this.setupNonAutoDetectAccordionRowCallback=d;var m=this;c._hiddenRowHTML=a("#hidden-accordion-content").html();a("#hidden-accordion-content").html("");k.log("Cleared hidden html");if(!p||l)a("#diagnosticsSpinnerDiv").show(),g.hide("autoDetectionAccordion"),c._clickedAlready=!0,m.primaryAccordionClick();else e.on("a:accordion:buybox-accordion:buyBackAccordionRow:select",
function(b){a("#diagnosticsSpinnerDiv").show();g.hide("autoDetectionAccordion");c._clickedAlready=!0;m.primaryAccordionClick()});a("#autoDiagnosticsIngress").click(function(){b.increment("BuyBack:mobile:runDiagnostic:click:count");m.startDiagnosticsFlow()});e.on("a2i_dpx:buyback:processBBPageState",function(){k.log("diagnostics:a2i_dpx:buyback:processBBPageState");m.buyBackState=q.getUpdatedState()});e.on("a:accordion:buybackAccordion:withAutoDetection-accordion:select",function(a){n("#buyBackBuyNowButton").disable();
g.hide("buyBackConfirmButton");m.accordionClick()});this.triggerAutoClick();this.triggerAutoClickAfterDiagnostics()},setAutoDetectDiscount:function(a,b){k.log("setAutoDetectDiscount");var d={discount:0,offerId:""};if(null!==this.buyBackState.buyBackExchangeItems&&this.buyBackState.buyBackExchangeItems!==l){for(var e=0;e<this.buyBackState.buyBackExchangeItems.length;e++){var g=this.buyBackState.buyBackExchangeItems[e];if(a.toUpperCase()===g.header.toUpperCase()){c._deviceBrandName=g.header;g=g.containedBuyBackProductNodes;
for(var p=0;p<g.length;p++)if(b.toUpperCase()===g[p].header.toUpperCase())return d.discount=g[p].buyBackProductDetails.buyBackOfferDetailsList[0].discountPrice,d.offerId=g[p].buyBackProductDetails.buyBackOfferDetailsList[0].offerId,d}}return d}},accordionClick:function(){k.log("accordionClick");"BB"!==this.buyBackState.programName?this.showADRowBeforeDiagnostics():(c._imeiNumber=this.buyBackState.imeiNumber,c._deviceBrandName=this.buyBackState.deviceBrandName,c._deviceModelName=this.buyBackState.deviceModelName,
this.showADRowAfterDiagnostics())},showADRowBeforeDiagnostics:function(){k.log("showADRowBeforeDiagnostics");g.hide("autoDiagnosticsIngress");a("#brand").text(c._deviceBrandName).removeClass("hide").addClass("show");a("#deviceBrand").val(c._deviceBrandName);a("#model").text(c._deviceModelName).removeClass("hide").addClass("show");a("#deviceModel").val(c._deviceModelName);a("#imei").val(c._imeiNumber);var d=this.setAutoDetectDiscount(c._deviceBrandName,c._deviceModelName),e=g.getSponsoredDiscount(this.buyBackState,
d.offerId,d.discount,c._imeiNumber);a("#deviceBuyBackDiscount").val(parseFloat(d.discount));a("#deviceSponsorDiscount").val(parseFloat(e));var m=g.getMaxDiagnosticsDiscount(this.buyBackState,c._imeiNumber);if(0===m||1>parseFloat(m.MaximumDiagnosticDiscount)){var u=parseFloat(d.discount)+parseFloat(e);d=parseFloat(this.buyBackState.productPrice)-(parseFloat(d.discount)+parseFloat(e));g.hide("autoDiagnosticsIngressRunDiagnosticText")}else null!==m.DisplayableDiagnosticDiscount&&0!==parseFloat(m.DisplayableDiagnosticDiscount,
10)?(u=parseFloat(d.discount)+parseFloat(e)+parseFloat(m.DisplayableDiagnosticDiscount),d=parseFloat(this.buyBackState.productPrice)-(parseFloat(d.discount)+parseFloat(e)+parseFloat(m.DisplayableDiagnosticDiscount)),a("#diagnosticsDiscountsReceivedValue").text(m.DisplayableDiagnosticDiscount),g.showInline("diagnosticsDiscountsReceivedText","diagnosticsDiscountsReceivedValue"),a("#maxDisplayedDiscountValue").val(m.MaximumDiagnosticDiscount),g.hide("autoDiagnosticsIngressRunDiagnosticText"),g.show("autoDiagnosticsIngressRunAgainText")):
(u=parseFloat(d.discount)+parseFloat(e),d=parseFloat(this.buyBackState.productPrice)-(parseFloat(d.discount)+parseFloat(e)),g.showInline("getAdditionalDiagnosticsDiscountText","getAdditionalDiscountvalue"),a("#getAdditionalDiscountvalue").text(m.MaximumDiagnosticDiscount),a("#maxDisplayedDiscountValue").val(m.MaximumDiagnosticDiscount));0!==parseFloat(e)&&(a("#mdSponsoredDiscountValue").text(parseFloat(e)),g.showInline("mdSponsoredDiscountValue"),g.show("mdSponsoredDiscountText"),b.increment("BuyBack::shouldDisplaySponsorMessage:count"));
this.applyChargeFee();if(""!==this.buyBackState.convenienceFee){if(e=Number(this.buyBackState.convenienceFee),d+=parseFloat(this.buyBackState.convenienceFee),a("#isBuyBackFee")[0]===l?this.addBuyBackFeeAsDigitalToBuyBackForm():this.setCustomKeyValueForFeeAsin(),g.show("buyBackConvenienceFeeTextSection"),a("#buyBackConvenienceFeeTextSection #convenienceFeeCharge").text(e),!this.buyBackState.dflEligible||this.buyBackState.executingFeature!==l&&this.buyBackState.executingFeature===r.EXECUTING_FEATURE_NAME_VSX)g.show("buyBackConvenienceFeeTextSectionForSOPP",
"mdBuyBackConvenienceFeeTextSectionForSOPP"),a("#buyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(e),a("#mdBuyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(e)}else this.resetFeeFormParams();this.buyBackState.deviceTotalDiscount=u;q._buyBackState=this.buyBackState;g.show("autoDiagnosticsIngress");a("#mdTotalDiscountValue").text(u);g.showInline("mdTotalDiscountCurrency","mdTotalDiscountValue");a("#priceAfterBuyBackDiscount").text(g.getFormattedPrice(d));g.hide("maxBuyBackDiscountSection");
g.show("priceAfterBuyBackDiscountSection");n("#buyBackBuyNowButton").enable();g.show("buyBackConfirmButton")},addBuyBackFeeAsDigitalToBuyBackForm:function(){a("#buyBackBuyNow").append('\x3cinput type\x3d"hidden" id\x3d"isBuyBackKey" name\x3d"custom-name.2.1" value\x3d"UNIQ-buyBack"\x3e\x3cinput type\x3d"hidden" id\x3d"isBuyBackFee" name\x3d"custom-value.2.1" value\x3d"BuyBackFee"\x3e')},setCustomKeyValueForFeeAsin:function(){a("#isBuyBackKey").val("UNIQ-buyBack");a("#isBuyBackFee").val("BuyBackFee")},
resetFeeFormParams:function(){a("#isBuyBackKey")[0]!==l&&a("#isBuyBackKey")[0].value!==l&&a("#isBuyBackKey").val("");a("#isBuyBackFee")[0]!==l&&a("#isBuyBackFee")[0].value!==l&&a("#isBuyBackFee").val("")},applyChargeFee:function(){var d=this.buyBackState.buyBackCategory.toLowerCase()+"_mobile";this.buyBackState.convenienceFee="";if(this.buyBackState.feeMap===l)d="BuyBack:mobile:noEntryExistsFor"+this.buyBackState.buyBackCategory.toLowerCase()+":count",b.increment(d);else if(this.buyBackState.feeMap.map[d]===
l)b.increment("BuyBack:mobile:noEntryExistsFor"+d+":count");else if(!0===this.buyBackState.feeMap.map[d].feeEnabled){this.buyBackState.convenienceFee=this.buyBackState.feeMap.map[d].price;a("#feeAsinPrice").val(this.buyBackState.convenienceFee);var c=this.buyBackState.pageLoadAsinList+"|"+this.buyBackState.feeMap.map[d].asin;a("#buyBackBuyNow #a").val(c);d=this.buyBackState.pageLoadOfferingIdList+"|"+this.buyBackState.feeMap.map[d].offeringId;a("#buyBackBuyNow #oid").val(d);d=this.buyBackState.pageLoadQuantity+
"|1";a("#buyBackBuyNow #quantity").val(d)}else b.increment("BuyBack:mobile:feeDisabledFor"+d+":count")},showADRowAfterDiagnostics:function(){k.log("showADRowAfterDiagnostics");a("#brand").text(c._deviceBrandName).removeClass("hide").addClass("show");a("#deviceBrand").val(c._deviceBrandName);a("#model").text(c._deviceModelName).removeClass("hide").addClass("show");a("#deviceModel").val(c._deviceModelName);a("#imei").val(c._imeiNumber);if(isNaN(this.buyBackState.deviceSponsoredDiscount)||null===this.buyBackState.deviceSponsoredDiscount||
""===this.buyBackState.deviceSponsoredDiscount)this.buyBackState.deviceSponsoredDiscount="0.0";var b=parseFloat(this.buyBackState.deviceBuyBackDiscount,10)+parseFloat(this.buyBackState.deviceSponsoredDiscount,10)+parseFloat(this.buyBackState.deviceDiagnosticsDiscount,10);this.buyBackState.deviceTotalDiscount=b;q._buyBackState=this.buyBackState;a("#mdTotalDiscountValue").text(b);g.showInline("mdTotalDiscountCurrency","mdTotalDiscountValue");a("#diagnosticsDiscountsReceivedValue").text(this.buyBackState.deviceDiagnosticsDiscount);
g.showInline("diagnosticsDiscountsReceivedText","diagnosticsDiscountsReceivedValue");b=parseFloat(this.buyBackState.devicePriceAfterDiagnostics,10);this.applyChargeFee();if(""!==this.buyBackState.convenienceFee){var e=Number(this.buyBackState.convenienceFee);b+=parseFloat(this.buyBackState.convenienceFee);a("#isBuyBackFee")[0]===l?this.addBuyBackFeeAsDigitalToBuyBackForm():this.setCustomKeyValueForFeeAsin();g.show("buyBackConvenienceFeeTextSection");a("#buyBackConvenienceFeeTextSection #convenienceFeeCharge").text(e);
if(!this.buyBackState.dflEligible||this.buyBackState.executingFeature!==l&&this.buyBackState.executingFeature===r.EXECUTING_FEATURE_NAME_VSX)g.show("buyBackConvenienceFeeTextSectionForSOPP","mdBuyBackConvenienceFeeTextSectionForSOPP"),a("#buyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(e),a("#mdBuyBackConvenienceFeeTextSectionForSOPP #convenienceFeeCharge").text(e)}else this.resetFeeFormParams();a("#priceAfterBuyBackDiscount").text(g.getFormattedPrice(b));g.hide("maxBuyBackDiscountSection");
g.show("priceAfterBuyBackDiscountSection");b=g.getMaxDiagnosticsDiscount(this.buyBackState,c._imeiNumber);a("#maxDisplayedDiscountValue").val(b.MaximumDiagnosticDiscount);g.hide("autoDiagnosticsIngressRunDiagnosticText");g.show("autoDiagnosticsIngressRunAgainText");n("#buyBackBuyNowButton").enable();g.show("buyBackConfirmButton")}}});"use strict";m.when("A","a-button","BBPageState","bbMetric","buyback-util","buyBackPageStateStatic").register("gep-util",function(e,n,g,b,l){var c=e.$;return{isGEPEligibleCustomer:function(b){return b.gepEligible},
showGEPDivPostIMEIValidation:function(e){b.increment("BuyBack:GEP:IMEIVerifiedWithCashify:count");e.discountAppliedText?e.gepSuccessNoteText?(c("#buyBackGEPIMEISuccessAlert span").html(e.discountAppliedText),c("#buyBackGEPSuccessNotes span").html(e.gepSuccessNoteText),l.show("buyBackGEPIMEISuccessAlert","buyBackGEPSuccessNotes"),l.hide("buyBackGEPNotEligibleAlert"),b.increment("BuyBack:GEP:successNoteShown:count")):e.gepFailureNoteText?(c("#buyBackGEPNotEligibleAlert").html(e.gepFailureNoteText),
l.hide("buyBackGEPIMEISuccessAlert"),l.show("buyBackGEPNotEligibleAlert"),b.increment("BuyBack:GEP:gepNotEligible:count")):(b.increment("BuyBack:GEP:EmptySucessAndFailureNote:count"),l.hide("buyBackGEPIMEISuccessAlert","buyBackGEPNotEligibleAlert")):(l.hide("buyBackIMEISection","buyBackSponsoredDiscountText","buyBackApplyOrCancelButtons","successIcon","buyBackConvenienceFeeTextSectionModal","buyBackIMEIUpdate"),c("#buyBackGEPNotEligibleAlert").html(e.gepFailureNoteText),l.show("buyBackGEPNotEligibleAlert"),
n("#buyBackBuyNowButton").disable(),b.increment("BuyBack:GEP:gepNotEligibleWhenRegularExchangeNotPresent:count"))},updateBuyBackDiscountDivsForGepEligibleBrandModel:function(b,e){b.selectedBuyBackOfferData.gepEligibleBrandModel&&(c("#buyBackDiscountPrice").text(l.getFormattedPrice(e)),c("#buyBackDiscountPriceInsideAccordion").text(l.getFormattedPrice(e)))}}});"use strict";m.when("A").register("Logger",function(e){return{_enable:!1,log:function(e){this._enable&&console.log(e)}}});"use strict";m.when().register("SOPPHelper",
function(){return{loadPageState:function(){}}});"use strict";m.when("A","BBPageState","buyBackPageStateStatic").execute(function(e,n){function g(){c(k).unbind("click").click(function(){m||(m=1,c("#bb-warranty-container").append(c(u+" #addToCart #abbWrapper")))});c(u).unbind("click").click(function(){m&&(m=0,1===t.length&&a.before(c("#bb-warranty-container #abbWrapper")))})}function b(){0<c("#withExchangeOffer-accordion").length?(k="#withExchangeOffer-accordion",u="#withoutExchangeOffer-accordion",
t=c(u+" #addToCart").children(".a-section")):(k="#buyBackAccordionRow",u="#newAccordionRow",t=c(u+" #addToCart  #desktop_qualifiedBuyBox").children(".a-section"));a=c(u+" #addToCart #abbWrapper").next()}var m=0,c=e.$,k="",u="",t="",a=null;n.init();n=n.get();n!==l&&"T1"===n.warrantyWeblabTreatment&&!0===n.hasValidBuyBackOffers&&(b(),g(),e.on("a:pageUpdate",function(){m=0;b();g()}))});m.when("A").execute(function(e){function l(){g("#buyBackBuyNowButton").unbind("click").click(function(){var b=g("#buyBackBuyNow"),
e=b.find('input[name\x3d"itemCount"]');0===e.length?b.append('\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"14"\x3e'):e[0].value=14})}var g=e.$;l();e.on("a2i_dpx:buyback:processBBPageState",function(){l()})});"use strict";m.when("A","buyBackConstants","valueCommensurateConstants","Logger","bbMetric","atf").register("valueCommensurateUtils",function(e,l,g,b,q){var c=l.common,k=l.RTLAErrorStatus,n=g.cssClass,t=g.common,a=g.action,r=g.metricName;return{toggleOff:function(a){b.log("toggleOff");
a.removeClass(n.TOGGLE_ON).addClass(n.TOGGLE_OFF)},toggleOn:function(a){b.log("toggleOn");a.removeClass(n.TOGGLE_OFF).addClass(n.TOGGLE_ON)},renderValueCommensurateManualBucketTemplates:function(d){b.log("renderValueCommensurateManualBucketTemplates");e.ajax(t.RENDER_MANUAL_BUCKET_TEMPLATES_URL,{method:c.POST,params:{buyBackItemId:d.buyBackItemId,totalBuyBackDiscount:d.totalBuyBackDiscount,baseBuyBackDiscount:d.baseBuyBackDiscount,buyBackCategory:d.buyBackCategory,deviceType:d.deviceType},success:function(b){q.increment(r.RENDER_MANUAL_BUCKET_TEMPLATES_SUCCESS);
var c={};c.html=b;c.loadedSuccessfully=!0;e.trigger(a.VALUE_COMMENSURATE_TEMPLATE_RENDERED,c)},error:function(b){q.increment(r.RENDER_MANUAL_BUCKET_TEMPLATES_FAILURE);e.trigger(a.VALUE_COMMENSURATE_TEMPLATE_RENDERED,{html:"",loadedSuccessfully:!1});m.log("Caught error in renderValueCommensurateManualBucketTemplates, Error: "+JSON.stringify(b),k.ERROR,"valueCommensurateUtils")}})},saveValueCommensurateCustomerData:function(a){b.log("saveValueCommensurateCustomerData");a={buyBackItemId:a.buyBackItemId,
buyBackCategory:a.buyBackCategory,requestId:a.requestId,campaignId:a.campaignId,listOfManualDefects:JSON.stringify(a.listOfManualDefects)};e.ajax(t.SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_URL,{method:c.POST,params:a,success:function(a){q.increment(r.SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_SUCCESS)},error:function(a){q.increment(r.SAVE_VALUE_COMMENSURATE_CUSTOMER_DATA_FAILURE);m.log("Caught error in saveValueCommensurateCustomerData, Error: "+JSON.stringify(a),k.ERROR,"valueCommensurateUtils")}})},getVCHandlerDataFromBuyBackData:function(a){var b=
{},d=a.selectedBuyBackOfferData.offerId.split(c.DELIMITER);d=d[4]+c.DELIMITER+d[5];b.buyBackCategory=a.buyBackCategory;b.buyBackItemId=d;b.requestId=a.valueCommensurateRequestId;b.deviceType=c.DEVICE_TYPE;b.totalBuyBackDiscount=a.selectedBuyBackOfferData.discountPrice+a.totalSponsoredValue+a.purchaseHistoryDiscount;b.baseBuyBackDiscount=a.selectedBuyBackOfferData.discountPrice+a.purchaseHistoryDiscount;return b}}});"use strict";m.when("A","a-dropdown").register("bb-first-dropdown",function(e,l){var g=
e.$;return{loadOptions:function(b){var e=l.getSelect("buyBackDropDown1");e&&g.each(b,function(b,g){e.addOption({text:g.header,value:g.header},b)})}}})});